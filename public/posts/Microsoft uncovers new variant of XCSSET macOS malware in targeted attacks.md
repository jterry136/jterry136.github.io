# Microsoft Threat Intelligence researchers found a new XCSSET macOS malware variant used in limited attacks.

## Evolving Threat: Microsoft Details New XCSSET macOS Malware Variant

Microsoft Threat Intelligence has recently documented a sophisticated new variant of XCSSET, a potent macOS malware, currently being deployed in targeted attacks. This variant exhibits refined capabilities, leveraging novel techniques to maintain persistence, exfiltrate sensitive data, and manipulate browser environments, highlighting an escalating threat to the macOS ecosystem, particularly within developer communities.

The initial compromise vector for this XCSSET variant is a supply chain attack. Threat actors embed malicious code within seemingly legitimate Xcode projects. When a developer compiles and runs one of these compromised projects, the Xcode build process inadvertently executes a malicious run script phase. This script initiates the infection, deploying the XCSSET payload onto the developer's system. This method is particularly insidious as it exploits trust in development workflows and can propagate further down the software supply chain if infected developers inadvertently embed the malware into their own projects.

Upon successful execution, XCSSET establishes persistence through the installation of LaunchAgents. The malware's modular architecture enables a wide array of malicious activities. Core functionalities include comprehensive data exfiltration, targeting credentials, cookies, and browsing history from widely used browsers such as Safari, Google Chrome, and Mozilla Firefox. It also incorporates keylogging capabilities and regular screenshot capture to monitor victim activity.

A distinctive and advanced feature of this XCSSET variant is its ability to abuse browser developer tools for malicious JavaScript injection. By leveraging the WebKit/Chromium debugger API available in Safari and Chrome, respectively, XCSSET can inject arbitrary JavaScript code into legitimate websites accessed by the victim. This allows the threat actors to modify website content, phish credentials, or redirect users without direct browser extension installation or traditional Man-in-the-Browser techniques. This represents a significant bypass of standard browser security mechanisms.

Furthermore, the malware demonstrates an ability to bypass Transparency, Consent, and Control (TCC) protections, which are designed to safeguard user data access. It achieves this by abusing the applicationâ€™s developer signature, providing elevated privileges for unauthorized access to sensitive user data. Beyond data theft, XCSSET is engineered to deploy additional payloads, including cryptocurrency miners, further monetizing compromised systems.

The activity of XCSSET has been observed since at least 2020, with previous iterations primarily targeting macOS users via supply chain attacks involving Xcode projects. This new variant underscores the persistent evolution of macOS-specific threats and the focus of adversaries on compromising development environments.

Defensive strategies against such sophisticated threats necessitate a multi-layered approach. Developers must exercise extreme caution regarding third-party code, scrutinizing all external dependencies and build scripts. Implementing robust endpoint detection and response (EDR) solutions capable of monitoring macOS-specific behaviors, especially processes spawned during application builds, is crucial. Regular software updates and maintaining a stringent security posture, including the principle of least privilege, are fundamental in mitigating the risk posed by advanced macOS malware like XCSSET.